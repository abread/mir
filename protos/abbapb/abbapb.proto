syntax = "proto3";

package abbapb;

option go_package = "github.com/filecoin-project/mir/pkg/pb/abbapb";

import "commonpb/commonpb.proto";
import "mir/plugin.proto";


// ============================================================
// Events
// ============================================================

message Event {
  oneof type {
    option (mir.event_type) = true;
    InputValue input_value = 1;
    Deliver    deliver     = 2;
  }
}

message InputValue {
  bool input = 1;
}

message Deliver {
  bool result = 1;
}


// ============================================================
// Messages
// ============================================================

message Message {
  oneof type {
    FinishMessage finish_message = 1;
    InitMessage   init_message   = 2;
    AuxMessage    aux_message    = 3;
    ConfMessage   conf_message   = 4;
    CoinMessage   coin_message   = 5;
  }
}

message FinishMessage {
    bool value = 1;
}

message InitMessage {
    uint64 round_number = 1;
    bool   estimate     = 2;
}

message AuxMessage {
    uint64 round_number = 1;
    bool   value        = 2;
}

message ConfMessage {
    uint64   round_number = 1;
    ValueSet values       = 2;
}

message CoinMessage {
    uint64 round_number = 1;
    bytes  coin_share   = 2;
}

enum ValueSet {
    EMPTY = 0;
    ZERO = 1;
    ONE = 2;
    ZERO_AND_ONE = 3;
}


// ============================================================
// Instantiation parameters
// ============================================================

message InstanceParams {
  commonpb.Membership membership = 1;
}
